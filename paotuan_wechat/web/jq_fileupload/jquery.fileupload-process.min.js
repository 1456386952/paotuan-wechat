(function(a){if(typeof define==="function"&&define.amd){define(["jquery","./jquery.fileupload"],a)}else{a(window.jQuery)}}(function(a){var b=a.blueimp.fileupload.prototype.options.add;a.widget("blueimp.fileupload",a.blueimp.fileupload,{options:{processQueue:[],add:function(f,d){var c=a(this);d.process(function(){return c.fileupload("process",d)});b.call(this,f,d)}},processActions:{},_processFile:function(d,f){var g=this,e=a.Deferred().resolveWith(g,[d]),c=e.promise();this._trigger("process",null,d);a.each(d.processQueue,function(j,k){var h=function(i){if(f.errorThrown){return a.Deferred().rejectWith(g,[f]).promise()}return g.processActions[k.action].call(g,i,k)};c=c.pipe(h,k.always&&h)});c.done(function(){g._trigger("processdone",null,d);g._trigger("processalways",null,d)}).fail(function(){g._trigger("processfail",null,d);g._trigger("processalways",null,d)});return c},_transformProcessQueue:function(c){var d=[];a.each(c.processQueue,function(){var g={},e=this.action,f=this.prefix===true?e:this.prefix;a.each(this,function(h,i){if(a.type(i)==="string"&&i.charAt(0)==="@"){g[h]=c[i.slice(1)||(f?f+h.charAt(0).toUpperCase()+h.slice(1):h)]}else{g[h]=i}});d.push(g)});c.processQueue=d},processing:function(){return this._processing},process:function(c){var e=this,d=a.extend({},this.options,c);if(d.processQueue&&d.processQueue.length){this._transformProcessQueue(d);if(this._processing===0){this._trigger("processstart")}a.each(c.files,function(g){var h=g?a.extend({},d):d,f=function(){if(c.errorThrown){return a.Deferred().rejectWith(e,[c]).promise()}return e._processFile(h,c)};h.index=g;e._processing+=1;e._processingQueue=e._processingQueue.pipe(f,f).always(function(){e._processing-=1;if(e._processing===0){e._trigger("processstop")}})})}return this._processingQueue},_create:function(){this._super();this._processing=0;this._processingQueue=a.Deferred().resolveWith(this).promise()}})}));